<div class="sidebar" [class.collapsed]="isCollapsed">
  <!-- Navigation Section -->
  <div class="sidebar-nav">

    <!-- Collapsed Navigation -->
    <div *ngIf="isCollapsed" class="collapsed-navigation">
      <!-- Home button -->
      <div class="collapsed-section-btn">
        <button 
          class="section-icon-btn home-btn"
          title="Home"
          routerLink="/"
          (click)="onPageClick()">
          <i class="bi bi-house-fill"></i>
        </button>
      </div>
      
      <!-- Section buttons -->
      <div *ngFor="let section of sections; trackBy: trackByName" class="collapsed-section-btn">
        <button 
          class="section-icon-btn"
          [class.active]="isSectionActive(section)"
          [title]="section.name"
          (click)="section.hasContent ? navigateToSection(section) : toggleSection(section)">
          <i [class]="section.icon"></i>
        </button>
      </div>
    </div>

    <!-- Expanded Navigation -->
    <div *ngIf="!isCollapsed">
      <!-- Home Link -->
      <div class="nav-section mb-2">
        <div class="section-header home-section" 
             routerLink="/" 
             routerLinkActive="active"
             [routerLinkActiveOptions]="{exact: true}"
             (click)="onPageClick()">
          <div class="section-content-wrapper">
            <i class="bi bi-house-fill me-2"></i>
            <strong>Home</strong>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="text-center p-3">
        <div class="spinner-border spinner-border-sm" role="status">
          <span class="visually-hidden">Loading navigation...</span>
        </div>
        <p class="mt-2 small">Loading navigation...</p>
      </div>

      <!-- Navigation Content -->
      <div class="nav-sections" *ngIf="!isLoading">
        
        <!-- Expanded state: Full navigation -->
        <div class="expanded-navigation">
          <!-- Sections -->
          <div class="nav-section" *ngFor="let section of sections; trackBy: trackByName">
        
        <!-- Section Header -->
        <div class="section-header" (click)="toggleSection(section)">
          <div class="section-content-wrapper" 
               [class.has-content]="section.hasContent"
               (click)="onSectionContentClick($event, section)">
            <i [class]="section.icon + ' me-2'"></i>
            <strong>{{ section.name }}</strong>
          </div>
          <i class="bi chevron-icon" 
             [class.bi-chevron-down]="section.isExpanded"
             [class.bi-chevron-right]="!section.isExpanded"></i>
        </div>
        
        <!-- Section Content -->
        <div class="section-content" *ngIf="section.isExpanded">
          
          <!-- Subsections ONLY - no direct pages -->
          <div *ngFor="let subsection of section.subsections; trackBy: trackByName" class="subsection">
            <div class="subsection-header" (click)="toggleSubsection(subsection)">
              <div class="subsection-content-wrapper" 
                   [class.has-content]="subsection.hasContent"
                   (click)="onSubsectionContentClick($event, section, subsection)">
                <i [class]="subsection.icon + ' me-2'"></i>
                <span>{{ subsection.name }}</span>
              </div>
              <i class="bi chevron-icon" 
                 [class.bi-chevron-down]="subsection.isExpanded"
                 [class.bi-chevron-right]="!subsection.isExpanded"></i>
            </div>
            
            <!-- Subsection Content (Pages) -->
            <div class="subsection-content" *ngIf="subsection.isExpanded">
              <a *ngFor="let page of subsection.pages; trackBy: trackByName"
                 [routerLink]="page.route" 
                 class="page-link"
                 routerLinkActive="active"
                 (click)="onPageClick()">
                <i [class]="page.icon + ' me-2'"></i>
                {{ page.title }}
              </a>
            </div>
          </div>
          
        </div>
      </div>
      
      <!-- Empty State -->
      <div *ngIf="sections.length === 0" class="text-center p-3">
        <p class="text-muted">No navigation available</p>
      </div>
      
    </div> <!-- End expanded-navigation -->
    </div> <!-- End nav-sections -->
  </div>

  <!-- Collapsed state toggle - mobile only -->
  <div class="text-center py-2 d-md-none" *ngIf="isCollapsed">
    <button class="btn btn-link" (click)="toggleSidebar()">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>

  <!-- Floating Desktop Toggle Button - Bottom Right -->
  <button class="floating-toggle-btn d-none d-md-block" (click)="toggleSidebar()">
    <i class="bi bi-chevron-left" *ngIf="!isCollapsed"></i>
    <i class="bi bi-chevron-right" *ngIf="isCollapsed"></i>
  </button>

  <!-- Copyright Section -->
  <div class="sidebar-footer" [class.collapsed]="isCollapsed">
    <div class="copyright-text">
      <span class="copyright-year">Â© 2025</span>
      <span class="copyright-name">Christian Haliga</span>
    </div>
  </div>
</div>
